<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
	</head>
	<style type="text/css">
		button {
			width: 100px;
			height: 50px;
			line-height: 50px;
			font-size: 18px;
			border-radius: 10px;
			background: none;
			border: 1px solid gray;
		}
	</style>

	<body>
		<button id="the-button">Try it 15!</button>
		<span id='debug'>
		</span>
	</body>

</html>
<script type="text/javascript">
	const debug = document.querySelector('#the-button');
	const button = document.querySelector('#the-button');
	//	debug.innerHTML(navigator.bluetooth);
	button.addEventListener('click', function() {
		console.log('=========')
		try {
			console.log('1')
			navigator.bluetooth.requestDevice({
					filters: [{
						service: ['www.jnhuamao.cn']
					}],
					acceptAllDevices: true
				})
				.then(function() {
					console.log('then')
				})
				.then(device => {
					console.log('Got device:' + device.name + 'id:' + device.id);
					//			debug.innerHTML('id:'+ device.id);
					//			console.log('3')
					return device.gatt.connect()
					//			console.log(device.gatt.connect())
				})
				.then(server => server.getPrimaryService('www.jnhuamao.cn'))
				.then(service => {
					sunFounder = service;
					return Promise.all({
						service.getCharacteristic()
					})
				});

		} catch(e) {
			console.log(false)
			//TODO handle the exception
		}

	});
</script>
